var signMoudle=function(){function n(n){n?($(".act_sign_box .sign_btn").removeClass("yet"),$(".act_sign_box .sign_btn .sign_yet_img").addClass("hide"),$(".act_sign_box .sign_btn .sign_yet_img").hide(),$(".act_sign_box .sign_btn .sign_img").removeClass("hide"),$(".act_sign_box .sign_btn .sign_img").show()):($(".act_sign_box .sign_btn").hasClass("yet")||$(".act_sign_box .sign_btn").addClass("yet"),$(".act_sign_box .sign_btn .sign_img").hide(),$(".act_sign_box .sign_btn .sign_yet_img").show(),$(".act_sign_box .sign_btn .sign_yet_img").removeClass("hide"),$(".act_sign_box .sign_btn .sign_img").addClass("hide"))}function i(n){$("#keepSignDays").html(n.data.keepSignDays),$("#totalSigninNum").html(n.data.totalSigninNum);for(var i,s=n.data.signinList,t=0;t<s.length;t++)i=s[t],$(".calendar").signCalander("setCoin",i.day,i.gifGold)}function s(){_.html("已签到").attr("disable","disable"),console.log(33333333333),$(".icon_head_fresh ").click()}function t(){var n=!1;return $.ajax({url:c.isSignToday,type:"post",async:!1,cache:!1,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(i){console.log(i),i.data.signToday>=1&&(n=!0,Util.popup.textUp("今天已签到"),s())},error:function(){}}),n}function a(t){d=!1,n(!1),t.data>0?(Util.popup.textUp("已签到成功，获得+"+t.data+"金币"),$.ajax({url:c.query,type:"post",async:!1,cache:!1,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(n){i(n),s()},error:function(){}})):Util.popup.textUp("今天已签到")}function e(){d||(d=!0,Util.popup.textUp("今日已签到"),r=setTimeout(function(){d=!1,clearTimeout(r)},2e3))}function o(s){console.log(s),d=!0;var t=template("sign",s.data);l.append(t),n(s.data.signToday<=0),$(".calendar").signCalander({year:s.data.year,month:s.data.month-1,gou:g+"../images/sign_ca/ca_gou.png"}),i(s),l.on("click",".act_close",function(){d=!1,l.find(".act_sign_box").remove(),l.find(".act_sign_mask").remove()}),l.on("click",".act_sign_box .sign_btn",function(){if($(this).hasClass("yet"))return void e();$(this).addClass("yet"),$.ajax({url:c.signin,data:{language:"zh_CN",osType:"pc"},type:"post",async:!1,cache:!1,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:a,error:function(){$(this).removeClass("yet"),Util.popup.textUp("签到失败！")}})})}var g=moudle.urlConfig.url,c={query:g+"api/sign/list",signin:g+"api/sign/signin",isSignToday:g+"api/sign/has-sign-today"},d=!1,l=$("body"),_=$("#sign-bar-btn"),r=null;return{renderSignPanel:o,renderGou:i,isSigned:t}}();
//# sourceMappingURL=../maps/sign.js.map
